  version: 2

  references:
    build_e2e: &build_e2e
      run:
        name: Build e2e
        command: make test-build

    run_e2e: &run_e2e
      run:
        name: Run e2e
        command: make test-start

    e2e: &e2e
      machine: true
      steps:
        - checkout:
            path: ~/project
        - *build_e2e
        - *run_e2e
    
  jobs:
    e2e:
      working_directory: ~/project/
      <<: *e2e

  workflows:
    version: 2
    test:
      jobs:
        - e2e